"use strict";(self["webpackChunkquasarteste2"]=self["webpackChunkquasarteste2"]||[]).push([[792],{1792:(a,l,e)=>{e.r(l),e.d(l,{default:()=>sa});var o=e(3673);const t=a=>((0,o.dD)("data-v-006c0640"),a=a(),(0,o.Cn)(),a),r={class:"q-pa-md",style:{"max-width":"400px"}},s=t((()=>(0,o._)("h5",{class:"q-mt-sm"},"Saída de veículo",-1))),c={class:"row q-col-gutter-xs"},d={class:"col-12"},n={class:"row row q-col-gutter-xs"},i={class:"col-4"},u={class:"col-2"},_=(0,o.Uk)(),m={class:"col-4"},p={class:"col-2"},v={class:"row row q-col-gutter-xs"},g={class:"col-6"},f={class:"col-6"},V={class:"row q-col-gutter-xs"},b={class:"col-6"},w={class:"col-6"},h={key:0,class:"row q-col-gutter-xs"},x={class:"col-6"},y={class:"col-6"},q={class:"col-6 col-md-6"},W={class:"col-6 col-md-6"},k={class:"row q-col-gutter-xs"},U={class:"col-12"},D={class:"row row q-col-gutter-xs"},Z={class:"col-12"},X={class:"row q-col-gutter-xs"},C={class:"col-4 col-md-4"},Q={class:"col-4 col-md-4"},S={class:"col-4 col-md-4"},H={class:"row row q-col-gutter-xs"},M={class:"col-6 col-md-6"},R={class:"col-6 col-md-6"},E=t((()=>(0,o._)("div",{class:"text-h6"},"Erro!",-1))),I=t((()=>(0,o._)("span",{class:"dialog_save_ok"},[(0,o._)("b",null,"Veículo não encontrado")],-1)));function P(a,l,e,t,P,F){const T=(0,o.up)("q-input"),Y=(0,o.up)("q-btn"),j=(0,o.up)("q-expansion-item"),z=(0,o.up)("q-list"),A=(0,o.up)("q-form"),B=(0,o.up)("q-card-section"),O=(0,o.up)("q-card-actions"),K=(0,o.up)("q-card"),L=(0,o.up)("q-dialog"),G=(0,o.Q2)("close-popup");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",r,[s,(0,o.Wm)(A,{class:"q-gutter-md",onSubmit:t.update,onReset:t.onReset},{default:(0,o.w5)((()=>[(0,o._)("div",c,[(0,o._)("div",d,[(0,o.Wm)(T,{class:"font1",modelValue:t.car.now_timestamp,"onUpdate:modelValue":l[0]||(l[0]=a=>t.car.now_timestamp=a),filled:"",label:"Hora e data atual",readonly:""},null,8,["modelValue"])])]),(0,o._)("div",n,[(0,o._)("div",i,[(0,o.Wm)(T,{mask:"XXXXXXX",class:"font2",modelValue:t.car.placa,"onUpdate:modelValue":l[1]||(l[1]=a=>t.car.placa=a),filled:"",label:"Placa",autofocus:""},null,8,["modelValue"])]),(0,o._)("div",u,[(0,o.Wm)(Y,{_class:"q-mt-sm",icon:"my_location",onClick:l[2]||(l[2]=a=>t.carsearch("placa",t.car.placa)),type:"button",color:"primary",_label:"Procurar",round:"",size:"md"})]),_,(0,o._)("div",m,[(0,o.Wm)(T,{mask:"XXXXXXX",class:"font2",modelValue:t.car.ticket,"onUpdate:modelValue":l[3]||(l[3]=a=>t.car.ticket=a),filled:"",label:"Ticket"},null,8,["modelValue"])]),(0,o._)("div",p,[(0,o.Wm)(Y,{_class:"q-mt-sm",icon:"my_location",onClick:l[4]||(l[4]=a=>t.carsearch("ticket",t.car.ticket)),type:"button",color:"primary",_label:"Procurar",round:"",size:"md"})])]),(0,o._)("div",v,[(0,o._)("div",g,[(0,o.Wm)(T,{class:"font2",modelValue:t.car.modelo,"onUpdate:modelValue":l[5]||(l[5]=a=>t.car.modelo=a),filled:"",label:"Modelo"},null,8,["modelValue"])]),(0,o._)("div",f,[(0,o.Wm)(T,{class:"font2",modelValue:t.car.cor,"onUpdate:modelValue":l[6]||(l[6]=a=>t.car.cor=a),filled:"",label:"Cor"},null,8,["modelValue"])])]),(0,o._)("div",V,[(0,o._)("div",b,[(0,o.Wm)(T,{class:"font1",modelValue:t.car.pago_ate,"onUpdate:modelValue":l[7]||(l[7]=a=>t.car.pago_ate=a),filled:"",label:"Pago até",readonly:""},null,8,["modelValue"])]),(0,o._)("div",w,[t.car.n_diarias_falta_pagar>0?((0,o.wg)(),(0,o.j4)(T,{key:0,class:"font1",modelValue:t.car.n_diarias_falta_pagar,"onUpdate:modelValue":l[8]||(l[8]=a=>t.car.n_diarias_falta_pagar=a),filled:"",label:"Diarias a pagar",readonly:""},null,8,["modelValue"])):(0,o.kq)("",!0),!t.car.n_diarias_falta_pagar||t.car.n_diarias_falta_pagar<=0?((0,o.wg)(),(0,o.j4)(T,{key:1,class:"font1",filled:"",label:"Status",modelValue:t.car.status,"onUpdate:modelValue":l[9]||(l[9]=a=>t.car.status=a),readonly:""},null,8,["modelValue"])):(0,o.kq)("",!0)]),t.car.n_diarias_falta_pagar>0?((0,o.wg)(),(0,o.iD)("div",h,[(0,o._)("div",x,[(0,o.Wm)(T,{class:"font2",modelValue:t.car.valor_diaria_falta_pagar,"onUpdate:modelValue":l[10]||(l[10]=a=>t.car.valor_diaria_falta_pagar=a),filled:"",label:"Valor da diária","input-class":"text-right"},null,8,["modelValue"])]),(0,o._)("div",y,[(0,o.Wm)(T,{class:"font2",modelValue:t.car.valor_total_falta_pagar,"onUpdate:modelValue":l[11]||(l[11]=a=>t.car.valor_total_falta_pagar=a),filled:"",type:"text",label:"Valor total a pagar","input-class":"text-right"},null,8,["modelValue"])]),(0,o._)("div",q,[(0,o.Wm)(T,{class:"font2",modelValue:t.car.valor_pago_falta_pagar,"onUpdate:modelValue":l[12]||(l[12]=a=>t.car.valor_pago_falta_pagar=a),filled:"",type:"text",label:"Valor pago","input-class":"text-right"},null,8,["modelValue"])]),(0,o._)("div",W,[(0,o.Wm)(T,{class:"font2",modelValue:t.car.valor_troco_falta_pagar,"onUpdate:modelValue":l[13]||(l[13]=a=>t.car.valor_troco_falta_pagar=a),filled:"",type:"text",label:"Troco","input-class":"text-right"},null,8,["modelValue"])])])):(0,o.kq)("",!0)]),(0,o.Wm)(z,{bordered:"",class:"rounded-borders"},{default:(0,o.w5)((()=>[(0,o.Wm)(j,{"expand-separator":"",label:"Detalhes"},{default:(0,o.w5)((()=>[(0,o._)("div",k,[(0,o._)("div",U,[(0,o.Wm)(T,{class:"font1",modelValue:t.car.in_timestamp,"onUpdate:modelValue":l[14]||(l[14]=a=>t.car.in_timestamp=a),filled:"",label:"Entrada",readonly:""},null,8,["modelValue"])])]),(0,o._)("div",D,[(0,o._)("div",Z,[(0,o.Wm)(T,{class:"font2",modelValue:t.car.obs,"onUpdate:modelValue":l[15]||(l[15]=a=>t.car.obs=a),filled:"",label:"Obs"},null,8,["modelValue"])])]),(0,o._)("div",X,[(0,o._)("div",C,[(0,o.Wm)(T,{class:"font2",modelValue:t.car.n_diarias,"onUpdate:modelValue":l[16]||(l[16]=a=>t.car.n_diarias=a),filled:"",label:"Diárias"},null,8,["modelValue"])]),(0,o._)("div",Q,[(0,o.Wm)(T,{class:"font2",modelValue:t.car.valor_diaria,"onUpdate:modelValue":l[17]||(l[17]=a=>t.car.valor_diaria=a),filled:"",label:"Valor da diária","input-class":"text-right"},null,8,["modelValue"])]),(0,o._)("div",S,[(0,o.Wm)(T,{class:"font2",modelValue:t.car.valor_total,"onUpdate:modelValue":l[18]||(l[18]=a=>t.car.valor_total=a),filled:"",type:"text",label:"Valor total","input-class":"text-right"},null,8,["modelValue"])])]),(0,o._)("div",H,[(0,o._)("div",M,[(0,o.Wm)(T,{class:"font2",modelValue:t.car.valor_pago,"onUpdate:modelValue":l[19]||(l[19]=a=>t.car.valor_pago=a),filled:"",type:"text",label:"Valor pago","input-class":"text-right"},null,8,["modelValue"])]),(0,o._)("div",R,[(0,o.Wm)(T,{class:"font2",modelValue:t.car.valor_troco,"onUpdate:modelValue":l[20]||(l[20]=a=>t.car.valor_troco=a),filled:"",type:"text",label:"Troco","input-class":"text-right"},null,8,["modelValue"])])])])),_:1})])),_:1}),(0,o._)("div",null,[t.car.valor_total_falta_pagar<=0||t.car.valor_troco_falta_pagar>=0?((0,o.wg)(),(0,o.j4)(Y,{key:0,label:"Registrar",type:"submit",color:"primary"})):(0,o.kq)("",!0),(0,o.Wm)(Y,{label:"Cancelar",type:"reset",color:"primary",flat:"",class:"q-ml-sm"})])])),_:1},8,["onSubmit","onReset"])]),(0,o.Wm)(L,{modelValue:t.dialog_nao_encontrado,"onUpdate:modelValue":l[21]||(l[21]=a=>t.dialog_nao_encontrado=a)},{default:(0,o.w5)((()=>[(0,o.Wm)(K,{style:{width:"300px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(B,null,{default:(0,o.w5)((()=>[E])),_:1}),(0,o.Wm)(B,{class:"q-pt-none"},{default:(0,o.w5)((()=>[I])),_:1}),(0,o.Wm)(O,{align:"right",class:"bg-white text-teal"},{default:(0,o.w5)((()=>[(0,o.wy)((0,o.Wm)(Y,{flat:"",label:"OK"},null,512),[[G]])])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}var F=e(8825),T=(e(1082),e(1959)),Y=e(9582),j=e(2052);e(8064);const z={setup(){var a=j.Z.firestore();const l=(0,Y.tv)(),e=(j.Z.auth().onAuthStateChanged((function(a){a||(alert("you must be logged in to view this. redirecting to the home page"),l.push("/"))})),(0,T.iH)(!0)),t=(0,T.iH)(!1),r=(0,F.Z)(),s=(0,T.iH)({in_timestamp:null,placa:null,modelo:null,cor:null,obs:null,n_diarias:0,valor_diaria:0,valor_total:0,valor_pago:0,valor_troco:0,status:null});let c=null;const d=(l,e)=>{c=null,console.log(l,e),s.value={in_timestamp:null,placa:null,modelo:null,cor:null,obs:null,n_diarias:0,valor_diaria:0,valor_total:0,valor_pago:0,valor_troco:0,status:null};const o=a.collection("carros");o.where(l,"==",e).where("out_timestamp","==",null).orderBy("in_timestamp","desc").limit(1).get().then((a=>{a.forEach((a=>{c=a.id,console.log(a.id," => ",a.data()),s.value.in_timestamp=n(a.data().in_timestamp),s.value.placa=a.data().placa,s.value.ticket=a.data().ticket,s.value.modelo=a.data().modelo,s.value.cor=a.data().cor,s.value.obs=a.data().obs,s.value.n_diarias=a.data().n_diarias,s.value.valor_diaria=a.data().valor_diaria,s.value.valor_total=a.data().valor_total,s.value.valor_pago=a.data().valor_pago,s.value.valor_troco=a.data().valor_troco,s.value.pago_ate=i(m(+a.data().in_timestamp,+a.data().n_diarias));let l=+new Date;console.log(l),s.value.n_diarias_falta_pagar=parseInt(+(l-m(+a.data().in_timestamp,+a.data().n_diarias))/1e3/86400),s.value.valor_diaria_falta_pagar=s.value.valor_diaria})),c||(t.value=!0)})).catch((a=>{console.log("Error getting documents: ",a)}))},n=a=>{const l=new Date(a),e=l.getDate()+"-"+(l.getMonth()+1)+"-"+l.getFullYear(),o=l.getHours()+":"+l.getMinutes()+":"+l.getSeconds(),t=o+" | "+e;return t},i=a=>{const l=new Date(a),e=l.getDate()+"-"+(l.getMonth()+1)+"-"+l.getFullYear(),o=(l.getHours(),l.getMinutes(),l.getSeconds(),e);return o},u=()=>{const a=new Date,l=a.getDate()+"-"+(a.getMonth()+1)+"-"+a.getFullYear(),e=a.getHours()+":"+a.getMinutes()+":"+a.getSeconds(),o=e+"  "+l;s.value.now_timestamp=o};(0,o.m0)((()=>{s.value.valor_total_falta_pagar=s.value.n_diarias_falta_pagar*s.value.valor_diaria_falta_pagar,s.value.valor_troco_falta_pagar=s.value.valor_pago_falta_pagar-s.value.valor_total_falta_pagar}));const _=()=>{s.value={in_timestamp:null,placa:null,modelo:null,cor:null,obs:null,n_diarias:1,valor_diaria:30,valor_total:0,valor_pago:0,valor_troco:0}},m=(a,l)=>{var e=new Date(a);return e.setDate(e.getDate()+l),e},p=async()=>{console.log(c),a.collection("carros").doc(c).update({out_timestamp:+new Date}),_(),console.log("car_searched_id:",c),r.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"Registro atualizado com sucesso!"})};return setInterval(u,1e3),{carro_encontrado:e,dialog_nao_encontrado:t,carsearch:d,update:p,car:s,onReset:_}}};var A=e(4260),B=e(8689),O=e(4842),K=e(8240),L=e(7011),G=e(4615),J=e(8886),N=e(6778),$=e(151),aa=e(5589),la=e(9367),ea=e(677),oa=e(7518),ta=e.n(oa);const ra=(0,A.Z)(z,[["render",P],["__scopeId","data-v-006c0640"]]),sa=ra;ta()(z,"components",{QForm:B.Z,QInput:O.Z,QBtn:K.Z,QList:L.Z,QExpansionItem:G.Z,QToggle:J.Z,QDialog:N.Z,QCard:$.Z,QCardSection:aa.Z,QCardActions:la.Z}),ta()(z,"directives",{ClosePopup:ea.Z})}}]);